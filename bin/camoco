#!/usr/bin/env python3

import camoco as co
import sys
import os

import argparse

def list_command(args):
    print(co.available_datasets(args.type,args.name))

def rm_command(args):
    print(co.del_dataset(args.type,args.name,safe=args.force))


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    subparsers = parser.add_subparsers(help='Camoco CLI')

    lstcmd = subparsers.add_parser('list',help='List camoco datasets.')
    lstcmd.add_argument('--type',default=None)
    lstcmd.add_argument('--name',default=None)
    lstcmd.set_defaults(func=list_command)

    rmcmd = subparsers.add_parser('rm',help='remove camoco dataset.')
    rmcmd.add_argument('--type',default=None)
    rmcmd.add_argument('--name',default=None)
    rmcmd.add_argument('-f','--force',action='store_false',default=True)
    rmcmd.set_defaults(func=rm_command)


    from IPython.core import ultratb
    sys.excepthook = ultratb.FormattedTB(mode='Verbose',
                 color_scheme='Linux', call_pdb=1)

    args = parser.parse_args()
    sys.exit(args.func(args))
